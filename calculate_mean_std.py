import math
import numpy as np


def calculate_mean_std(loader):

    mean = 0.
    std = 0.
    nb_samples = 0.
    for data in loader:
        data = data[0]
        batch_samples = data.size(0)
        data = data.view(batch_samples, data.size(1), -1)
        mean += data.mean(2).sum(0)
        std += data.std(2).sum(0)
        nb_samples += batch_samples

    mean /= nb_samples
    std /= nb_samples
    return mean, std

if __name__=="__main__":
    mean,std =calculate_mean_std()